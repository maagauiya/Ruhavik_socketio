<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<style>
  body{
    background-color: gray;
    overflow-y: hidden;
  }
    td{
        text-align: center !important;
    }
    th{
        text-align: center !important;

    }
    .leftalign{
      text-align: left !important;
      padding-bottom: 0px !important;
      padding-top: 0px !important;
    }

    .wrapper{
      display:flex;
  justify-content:space-between;
    }
    p {
      margin: 0 !important;
    }
    
iframe {
  /* width: 76.92% !important; */
  height: 110% !important;
  width: 125%; 
  -webkit-transform: scale(1.0);
  transform: scale(0.8);
  -webkit-transform-origin: 0 0;
  transform-origin: 0 0;
}
</style>
<body>
    <div class="container-fluids" >

        <div class="row">
            <div class="col" >
                <table class="table table-bordered" style="background-color: white;">
                    <thead class="table-light">
                      <tr>
                        <th scope="col" style="width: 60px !important; text-align: center !important;"><img src="/images/smth.png" alt="" width="30px" height="30px"></th>
                        <th scope="col">№ А/Т</th>
                        <th scope="col">Водитель</th>

                        <th scope="col" style="width: 60px !important; text-align: center !important;"><img src="/images/camera.png" width="30px" height="30px" alt=""></th>
                        <th scope="col" style="width: 60px !important; text-align: center !important;"><img src="/images/tools.png" alt="" width="30px" height="30px"></th>
                        <th scope="col" style="width: 60px !important; text-align: center !important;"><img src="/images/journal.png" alt="" width="30px" height="30px"></th>
                        <th scope="col">Пробег км</th>
                    
                    </tr>
                    </thead>
                    <tbody id="tbodyy">
                     
                      {% for car in cars%}
                      <tr>

                      {% if car.engine_state == False %}
                      <th  scope="row" style="padding: 0 !important;"><img id='{{car.id}}_engine' src="/images/red.png" alt="" width="40px" height="40px"></th>
                      {% else %}
                      <th  scope="row" style="padding: 0 !important;"><img id='{{car.id}}_engine' src="/images/green.png" alt="" width="40px" height="40px"></th>
                      {% endif %}
                        
                        <td id='{{car.id}}_number' >{{car.car_number}}</td>
                        <td id='{{car.id}}_name'>{{car.name_of_driver}}</td>
                      {% if car.camera_state == False %}
                      
                      <th  style="padding: 0 !important;"><img id='{{car.id}}_camera' src="/images/red.png" alt="" width="40px" height="40px"></th>
                      {% else %}
                      <th   style="padding: 0 !important;"><img id='{{car.id}}_camera' src="/images/green.png" alt="" width="40px" height="40px"></th>
                      {% endif %}
                      {% if car.service_state == False %}
                      <th   style="padding: 0 !important;"><img id='{{car.id}}_service' src="/images/red.png" alt="" width="40px" height="40px"></th>
                      {% else %}
                      <th   style="padding: 0 !important;"><img id='{{car.id}}_service' src="/images/green.png" alt="" width="40px" height="40px"></th>
                      {% endif %}
                        <!-- <td style="padding: 0 !important;"><img src="/images/green.png" alt="" width="40px" height="40px"></td> -->
                        <!-- <td style="padding: 0 !important;"><img src="/images/green.png" alt="" width="40px" height="40px"></td> -->
                        <td id='{{car.id}}_tasks'>{{car.tasks_state}}</td>
                        <td id='{{car.id}}_km'>{{car.km}}</td>
                      </tr>
                      
                      {%endfor%}
                      
                    </tbody>
                  </table>
            </div>
            <div class="col" style="background-color: white;">
              
            </div>
          </div>
          <div class="row">
            <div class="col-3" style="margin: 0 !important;">
              <table class="table table-bordered" style="background-color: white;">
              <thead class="table-light">
                <tr>
                  <th scope="col" class="leftalign" style="width: 20px;">№</th>
                  <th scope="col" class="leftalign" >Города</th>
                </tr>
              </thead>
              <tbody>
                
                
                {% for city in cities%}
                <tr>
                  <th scope="row" class="leftalign">{{loop.index}}</th>
                  <td class="leftalign" >
                    <div class="wrapper">
                      <div>
                          <p id='{{city._id}}_city'>{{city.city}}</p>
                      </div>
                      <div>
                        {% if city.state == False %}
                      
                        <img id='{{city._id}}_state' src="/images/red.png" alt="" width="30px" height="30px" style="padding: 0px !important;">
                        {% else %}
                        <img id='{{city._id}}_state' src="/images/green.png" alt="" width="30px" height="30px" style="padding: 0px !important;">
                        {% endif %}
                        
                      </div>
                    </div>
                  </td>
                </tr>
                {%endfor%}
              </tbody>
            </table></div>
            <div class="col-9"><iframe src="https://ruhavik.gurtam.space/units/all" frameborder="0" ></iframe></div>

            <!-- <div class="col-9"><iframe src="https://ruhavik.gurtam.space/units/all" frameborder="0" style="border-style: none; width: 100%; height: 100%;"></iframe></div> -->
          </div>
          


          <!-- <div class="row">
            <div class="col" style="background-color: aqua; height: 300px !important;">
              1 of 2
            </div>
            <div class="col" style="height: 300px !important;">
                <iframe src="https://ruhavik.gurtam.space/units/all" frameborder="0" style="border-style: none; width: 100%; height: 400px;"></iframe>

            </div>
          </div> -->
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
  <script type="text/javascript" charset="utf-8">
    socket = io();
    socket.connect("http://127.0.0.1:5000/");
    socket.on('connect', function() {
        socket.send('a');
    });
    socket.on('message', function(msg) {
      for (let i = 0; i <msg.cursor.length; i++){  
        if (msg.cursor[i]["engine_state"] == true){ 
          document.getElementById(msg.cursor[i]["id"]+"_engine").src = "/images/green.png" ;
        }
        else if (msg.cursor[i]["engine_state"] == false){ 
          document.getElementById(msg.cursor[i]["id"]+"_engine").src = "/images/red.png" ;

        }
        document.getElementById(msg.cursor[i]["id"]+"_number").textContent=msg.cursor[i]["car_number"];
        document.getElementById(msg.cursor[i]["id"]+"_name").textContent=msg.cursor[i]["name_of_driver"];
        if (msg.cursor[i]["camera_state"] == true){ 
          document.getElementById(msg.cursor[i]["id"]+"_camera").src = "/images/green.png";

        }
        else if(msg.cursor[i]["camera_state"] == false){ 
          document.getElementById(msg.cursor[i]["id"]+"_camera").src = "/images/red.png";
        }
        if(msg.cursor[i]["service_state"] == true){ 
          document.getElementById(msg.cursor[i]["id"]+"_service").src = "/images/green.png";

        }
        else if (msg.cursor[i]["service_state"] == false){ 
          document.getElementById(msg.cursor[i]["id"]+"_service").src = "/images/red.png";

        }
        document.getElementById(msg.cursor[i]["id"]+"_tasks").textContent=msg.cursor[i]["tasks_state"];

        document.getElementById(msg.cursor[i]["id"]+"_km").textContent=msg.cursor[i]["km"];
      }
      for (let i = 0; i <msg.cursor2.length; i++){   
        document.getElementById(msg.cursor2[i]["_id"]+"_city").textContent=msg.cursor2[i]["city"];
        if(msg.cursor2[i]["state"] == true){ 
          document.getElementById(msg.cursor2[i]["_id"]+"_state").src = "/images/green.png";

        }
        else if (msg.cursor2[i]["state"] == false){ 
          document.getElementById(msg.cursor2[i]["_id"]+"_state").src = "/images/red.png";

        }
      }

        socket.send('a')
    });

   
    

    // socket.on('message', data => {
      
    //                 console.log(data)
    //                 // if (data.msg.cursor.length > 0) {
    //                 //     if (data.username === 'Service message') {
    //                 //         $('#messages').append(`<li class="text-muted"><strong>${data.username}:</strong> ${data.msg.cursor}</li>`);
    //                 //     } else {
    //                 //         $('#messages').append(`<li><strong>${data.username}:</strong> ${data.msg.cursor}</li>`);
    //                 //     }
    //                 //     console.log('Received message');
    //                 // }
    //             });
          
</script>
</body>
</html>